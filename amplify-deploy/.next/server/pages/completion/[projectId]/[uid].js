(()=>{var e={};e.id=487,e.ids=[487,888,660],e.modules={4827:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{config:()=>g,default:()=>p,getServerSideProps:()=>h,getStaticPaths:()=>x,getStaticProps:()=>m,reportWebVitals:()=>v,routeModule:()=>w,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var i=t(7093),n=t(5244),a=t(1323),l=t(2899),o=t.n(l),c=t(3893),d=t(8652),u=e([d]);d=(u.then?(await u)():u)[0];let p=(0,a.l)(d,"default"),m=(0,a.l)(d,"getStaticProps"),x=(0,a.l)(d,"getStaticPaths"),h=(0,a.l)(d,"getServerSideProps"),g=(0,a.l)(d,"config"),v=(0,a.l)(d,"reportWebVitals"),f=(0,a.l)(d,"unstable_getStaticProps"),j=(0,a.l)(d,"unstable_getStaticPaths"),y=(0,a.l)(d,"unstable_getStaticParams"),b=(0,a.l)(d,"unstable_getServerProps"),S=(0,a.l)(d,"unstable_getServerSideProps"),w=new i.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/completion/[projectId]/[uid]",pathname:"/completion/[projectId]/[uid]",bundlePath:"",filename:""},components:{App:c.default,Document:o()},userland:d});s()}catch(e){s(e)}})},8925:(e,r,t)=>{"use strict";t.d(r,{_:()=>i});let s=require("@prisma/client"),i=global.prisma||new s.PrismaClient({log:["error"]})},3893:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(997),i=t(968),n=t.n(i);function a({Component:e,pageProps:r}){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n(),{children:[s.jsx("title",{children:"Survey Link Wrapper"}),s.jsx("meta",{name:"description",content:"Wrapping third-party survey links with a validation layer"}),s.jsx("link",{rel:"icon",href:"/favicon.ico"}),s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),s.jsx(e,{...r})]})}t(108)},8652:(e,r,t)=>{"use strict";t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{default:()=>p,getServerSideProps:()=>m});var i=t(997),n=t(6689),a=t(1163),l=t(968),o=t.n(l),c=t(9648),d=t(8925),u=e([c]);function p({project:e,surveyLink:r,error:t}){(0,a.useRouter)();let[s,l]=(0,n.useState)(!t&&!!r),[c,d]=(0,n.useState)(t||null),[u,p]=(0,n.useState)(!1);if(!e||!r)return i.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,i.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:[i.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Survey Not Found"}),i.jsx("p",{className:"text-gray-700 mb-6",children:"Sorry, the survey you are looking for does not exist or has expired."})]})});let m=r.vendorCode?`Thank you for completing the survey via ${r.vendorCode}.`:"Thank you for completing the survey.";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o(),{children:[(0,i.jsxs)("title",{children:["Survey Completed | ",e.name]}),i.jsx("meta",{name:"description",content:"Thank you for completing the survey"})]}),i.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:i.jsx("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:s?(0,i.jsxs)(i.Fragment,{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Recording Completion"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Please wait while we record your survey completion..."}),i.jsx("div",{className:"flex justify-center",children:i.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})})]}):c?(0,i.jsxs)(i.Fragment,{children:[i.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error"}),i.jsx("p",{className:"text-gray-700 mb-6",children:c}),i.jsx("p",{className:"text-sm text-gray-500",children:"If this error persists, please contact the survey administrator."})]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx("div",{className:"mb-6 flex justify-center",children:i.jsx("div",{className:"rounded-full bg-green-100 p-3",children:i.jsx("svg",{className:"h-12 w-12 text-green-600",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{d:"M5 13l4 4L19 7"})})})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Thank You!"}),(0,i.jsxs)("p",{className:"text-gray-600 mb-6",children:[m," Your response has been successfully recorded."]}),i.jsx("p",{className:"text-sm text-gray-500",children:"You may now close this window."})]})})})]})}async function m(e){let{projectId:r,uid:t}=e.params;try{let e=await d._.project.findUnique({where:{id:r},select:{id:!0,name:!0}});if(!e)return{props:{project:null,surveyLink:null,error:"Project not found"}};let s=await d._.surveyLink.findFirst({where:{projectId:r,uid:t},include:{vendor:{select:{code:!0}}}});if(!s)return{props:{project:e,surveyLink:null,error:"Survey link not found"}};return{props:{project:{id:e.id,name:e.name},surveyLink:{uid:s.uid,status:s.status,originalUrl:s.originalUrl,vendorCode:s.vendor?.code||null},error:null}}}catch(e){return console.error("Error fetching data:",e),{props:{project:null,surveyLink:null,error:"Error fetching data"}}}}c=(u.then?(await u)():u)[0],s()}catch(e){s(e)}})},108:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},2048:e=>{"use strict";e.exports=require("fs")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},1568:e=>{"use strict";e.exports=require("zlib")},9648:e=>{"use strict";e.exports=import("axios")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[899,132,163],()=>t(4827));module.exports=s})();