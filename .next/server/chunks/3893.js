exports.id=3893,exports.ids=[3893],exports.modules={4192:(e,t,s)=>{"use strict";s.d(t,{m:()=>i});let r=JSON.parse('{"auth":{"user_pool_id":"us-east-1_Gh00T12dW","aws_region":"us-east-1","user_pool_client_id":"5e5a5drp00jd43tr7ph1ceg412","identity_pool_id":"us-east-1:a0b02f73-93a3-4b52-b1cb-eaa306375a33","mfa_methods":["SMS"],"standard_required_attributes":["email"],"username_attributes":["email"],"user_verification_types":["email"],"groups":[],"mfa_configuration":"OPTIONAL","password_policy":{"min_length":8,"require_lowercase":true,"require_numbers":true,"require_symbols":true,"require_uppercase":true},"unauthenticated_identities_enabled":true},"data":{"url":"https://vth6pntotrhvfpxo2gwn3kzqry.appsync-api.us-east-1.amazonaws.com/graphql","aws_region":"us-east-1","api_key":"da2-ee26yqskvzfpjpquwbi53shbvu","default_authorization_type":"AWS_IAM","authorization_types":["API_KEY","AMAZON_COGNITO_USER_POOLS"],"model_introspection":{"version":1,"models":{"Project":{"name":"Project","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"description":{"name":"description","isArray":false,"type":"String","isRequired":false,"attributes":[]},"status":{"name":"status","isArray":false,"type":{"enum":"ProjectStatus"},"isRequired":false,"attributes":[]},"targetCompletions":{"name":"targetCompletions","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"currentCompletions":{"name":"currentCompletions","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"surveyUrl":{"name":"surveyUrl","isArray":false,"type":"String","isRequired":true,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"settings":{"name":"settings","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]}},"syncable":true,"pluralName":"Projects","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"private","operations":["create","read","update","delete"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"Question":{"name":"Question","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"projectId":{"name":"projectId","isArray":false,"type":"ID","isRequired":false,"attributes":[]},"text":{"name":"text","isArray":false,"type":"String","isRequired":true,"attributes":[]},"type":{"name":"type","isArray":false,"type":{"enum":"QuestionType"},"isRequired":false,"attributes":[]},"options":{"name":"options","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"sequence":{"name":"sequence","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"isRequired":{"name":"isRequired","isArray":false,"type":"Boolean","isRequired":true,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]}},"syncable":true,"pluralName":"Questions","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"private","operations":["create","read","update","delete"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"SurveyLink":{"name":"SurveyLink","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"projectId":{"name":"projectId","isArray":false,"type":"ID","isRequired":false,"attributes":[]},"uid":{"name":"uid","isArray":false,"type":"String","isRequired":true,"attributes":[]},"status":{"name":"status","isArray":false,"type":{"enum":"SurveyLinkStatus"},"isRequired":false,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"clickedAt":{"name":"clickedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"completedAt":{"name":"completedAt","isArray":false,"type":"AWSDateTime","isRequired":false,"attributes":[]},"ipAddress":{"name":"ipAddress","isArray":false,"type":"String","isRequired":false,"attributes":[]},"userAgent":{"name":"userAgent","isArray":false,"type":"String","isRequired":false,"attributes":[]},"geoData":{"name":"geoData","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"metadata":{"name":"metadata","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"vendorId":{"name":"vendorId","isArray":false,"type":"ID","isRequired":false,"attributes":[]}},"syncable":true,"pluralName":"SurveyLinks","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"private","operations":["create","read","update","delete"]},{"allow":"public","provider":"iam","operations":["read","update"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"Vendor":{"name":"Vendor","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"name":{"name":"name","isArray":false,"type":"String","isRequired":true,"attributes":[]},"contactName":{"name":"contactName","isArray":false,"type":"String","isRequired":false,"attributes":[]},"contactEmail":{"name":"contactEmail","isArray":false,"type":"String","isRequired":false,"attributes":[]},"settings":{"name":"settings","isArray":false,"type":"AWSJSON","isRequired":false,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]}},"syncable":true,"pluralName":"Vendors","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"private","operations":["create","read","update","delete"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}},"ProjectVendor":{"name":"ProjectVendor","fields":{"id":{"name":"id","isArray":false,"type":"ID","isRequired":true,"attributes":[]},"projectId":{"name":"projectId","isArray":false,"type":"ID","isRequired":false,"attributes":[]},"vendorId":{"name":"vendorId","isArray":false,"type":"ID","isRequired":false,"attributes":[]},"quota":{"name":"quota","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"currentCount":{"name":"currentCount","isArray":false,"type":"Int","isRequired":true,"attributes":[]},"createdAt":{"name":"createdAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]},"updatedAt":{"name":"updatedAt","isArray":false,"type":"AWSDateTime","isRequired":true,"attributes":[]}},"syncable":true,"pluralName":"ProjectVendors","attributes":[{"type":"model","properties":{}},{"type":"auth","properties":{"rules":[{"allow":"private","operations":["create","read","update","delete"]}]}}],"primaryKeyInfo":{"isCustomPrimaryKey":false,"primaryKeyFieldName":"id","sortKeyFieldNames":[]}}},"enums":{"ProjectStatus":{"name":"ProjectStatus","values":["ACTIVE","PAUSED","COMPLETED"]},"QuestionType":{"name":"QuestionType","values":["MULTIPLE_CHOICE","TEXT","COUNTRY","SCALE"]},"SurveyLinkStatus":{"name":"SurveyLinkStatus","values":["UNUSED","CLICKED","COMPLETED","DISQUALIFIED","QUOTA_FULL"]}},"nonModels":{}}},"version":"1.3"}');function i(){return r}},4685:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{H:()=>c,a:()=>l});var i=s(997),a=s(6689),n=s(7200),o=s(6839),u=e([n]);n=(u.then?(await u)():u)[0];let d=(0,a.createContext)(void 0);function c({children:e}){let[t,s]=(0,a.useState)(!1),[r,u]=(0,a.useState)(!0),[c,l]=(0,a.useState)(null),p=async()=>{try{u(!0);let e=await n.AuthService.isAuthenticated();if(s(e),e){let e=await n.AuthService.getCurrentUser(),t=await n.AuthService.getUserAttributes();l({...e,attributes:t})}else l(null)}catch(e){console.error("Error checking authentication:",e),s(!1),l(null),(0,o.nT)()}finally{u(!1)}},m=async(e,t)=>{let s=await n.AuthService.signIn({username:e,password:t});return s.isSuccess&&await p(),s},y=async()=>{await n.AuthService.signOut(),await p()},f=async e=>await n.AuthService.signUp(e),h=async e=>{let t=await n.AuthService.completeNewPassword(e);return t.isSuccess&&await p(),t},A=async()=>{try{await n.AuthService.refreshAuthState(),await p()}catch(e){console.error("Error refreshing auth state:",e)}},S={isAuthenticated:t,isLoading:r,user:c,login:m,logout:y,signUp:f,confirmSignUp:n.AuthService.confirmSignUp,completeNewPassword:h,refreshAuthState:A};return i.jsx(d.Provider,{value:S,children:e})}function l(){let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}r()}catch(e){r(e)}})},7200:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{AuthService:()=>o});var i=s(9779);s(4192);var a=s(5838),n=e([i,a]);[i,a]=n.then?(await n)():n;class o{static{this.sessionCheckPromise=null}static{this.lastSessionCheck=0}static{this.sessionCheckInterval=3e4}static{this.forceRefresh=!1}static async signUp(e){try{let{username:t,password:s,email:r,firstName:a,lastName:n}=e,o={email:r,...a&&{name:a},...n&&{family_name:n}},u=await (0,i.signUp)({username:t,password:s,options:{userAttributes:o}});return{isSuccess:!0,message:"Sign up successful! Please check your email for a verification code.",data:u}}catch(e){if(console.error("Sign up error:",e),"UsernameExistsException"===e.name)return{isSuccess:!1,message:"This username is already taken. Please try another one."};return{isSuccess:!1,message:e.message||"Failed to sign up. Please try again."}}}static async signIn(e){try{"undefined"!=typeof document&&document.cookie.split(";").forEach(e=>{let[t]=e.split("=").map(e=>e.trim());(t.includes("CognitoIdentityServiceProvider")||t.includes("amplify")||t.includes("Token"))&&(document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)});let{username:t,password:s}=e,r=await (0,i.signIn)({username:t,password:s});return await new Promise(e=>setTimeout(e,500)),await this.waitForSession(),{isSuccess:!0,message:"Successfully signed in",data:r,nextStep:r.nextStep}}catch(e){if(console.error("Sign in error:",e),"UserNotConfirmedException"===e.name)return{isSuccess:!1,message:"Please confirm your account by entering the verification code sent to your email."};if("NotAuthorizedException"===e.name)return{isSuccess:!1,message:"Incorrect username or password."};if("UserNotFoundException"===e.name)return{isSuccess:!1,message:"User does not exist."};return{isSuccess:!1,message:e.message||"Failed to sign in. Please try again."}}}static async confirmSignUp(e,t){try{await (0,i.confirmSignUp)({username:e,confirmationCode:t})}catch(e){throw console.error("Confirm sign up error:",e),e}}static async signOut(){try{await (0,i.signOut)({global:!0}),this.lastSessionCheck=0,this.sessionCheckPromise=null,"undefined"!=typeof document&&document.cookie.split(";").forEach(e=>{let[t]=e.split("=").map(e=>e.trim());(t.includes("CognitoIdentityServiceProvider")||t.includes("amplify")||t.includes("Token")||t.includes("auth"))&&(console.log("Clearing cookie after signout:",t),document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)})}catch(e){throw console.error("Sign out error:",e),"undefined"!=typeof document&&document.cookie.split(";").forEach(e=>{let[t]=e.split("=").map(e=>e.trim());(t.includes("CognitoIdentityServiceProvider")||t.includes("amplify")||t.includes("Token"))&&(document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)}),e}}static async getCurrentUser(){try{return await (0,i.getCurrentUser)()}catch(e){return null}}static async waitForSession(e=5){for(let t=0;t<e;t++)try{return await (0,i.fetchAuthSession)(),!0}catch(s){if(t===e-1)return!1;await new Promise(e=>setTimeout(e,1e3))}return!1}static async isAuthenticated(){let e=Date.now();return this.forceRefresh&&(this.forceRefresh=!1,this.lastSessionCheck=0,this.sessionCheckPromise=null),this.sessionCheckPromise&&e-this.lastSessionCheck<this.sessionCheckInterval||(this.sessionCheckPromise=(async()=>{try{let e=await (0,i.fetchAuthSession)(),t=!!e.tokens?.accessToken;return t?console.log("Valid authentication session found"):console.log("No valid authentication session"),t}catch(e){return console.error("Error checking authentication:",e),e instanceof Error&&e.message.includes("No current user"),!1}})(),this.lastSessionCheck=e),this.sessionCheckPromise}static async getUserAttributes(){try{return await (0,i.fetchUserAttributes)()}catch(e){return null}}static async updateUserAttributes(e){try{return await (0,i.updateUserAttributes)({userAttributes:e}),{isSuccess:!0,message:"User attributes updated successfully."}}catch(e){return console.error("Update user attributes error:",e),{isSuccess:!1,message:e.message||"Failed to update user attributes."}}}static async completeNewPassword(e){try{let t=await (0,i.confirmSignIn)({challengeResponse:e});return await this.waitForSession(),{isSuccess:t.isSignedIn,message:"Password set successfully."}}catch(e){return console.error("Complete new password error:",e),{isSuccess:!1,message:e.message||"Failed to set new password."}}}static async getIdToken(){try{let e=await (0,i.fetchAuthSession)();return e.tokens?.idToken?.toString()||null}catch(e){return console.error("Error getting ID token:",e),null}}static async refreshAuthState(){this.forceRefresh=!0,this.lastSessionCheck=0,this.sessionCheckPromise=null;try{let e=await (0,i.fetchAuthSession)();console.log("Auth session refreshed successfully",{hasIdToken:!!e.tokens?.idToken,hasAccessToken:!!e.tokens?.accessToken,hasTokens:!!e.tokens})}catch(e){console.error("Error refreshing auth session:",e)}}}r()}catch(e){r(e)}})},6839:(e,t,s)=>{"use strict";function r(e){if("undefined"==typeof document)return null;let t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`))?.split("=")[1];return t?decodeURIComponent(t):null}function i(e,t,s={}){if("undefined"==typeof document)return;let{days:r=7,path:i="/",domain:a,secure:n=!0,sameSite:o="lax"}=s,u=new Date;u.setTime(u.getTime()+864e5*r);let c=`${e}=${encodeURIComponent(t)}; expires=${u.toUTCString()}; path=${i}`;a&&(c+=`; domain=${a}`),n&&(c+="; secure"),c+=`; samesite=${o}`,document.cookie=c}function a(e,t={}){if("undefined"==typeof document)return;let{path:s="/",domain:r}=t,i=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${s}`;r&&(i+=`; domain=${r}`),document.cookie=i}function n(){if("undefined"==typeof document)return;let e=void 0;["amplify-signin-with-hostedUI","amplify-redirected-from-hosted-ui","amplify.auth.tokens","CognitoIdentityServiceProvider.*","amazon-cognito-advanced-security-data","aws.cognito.*","idToken","accessToken","refreshToken","auth_tokens","CognitoIdentityServiceProvider.*","Authorization"].forEach(t=>{t.includes("*")?document.cookie.split(";").forEach(s=>{let r=s.split("=")[0].trim();r.includes(t.replace("*",""))&&(a(r,{domain:e}),a(r))}):(a(t,{domain:e}),a(t))}),i("redirect_count","0",{days:1}),console.log("All authentication cookies cleared")}function o(){if("undefined"==typeof document)return;i("redirect_count","0",{days:1}),r("Authorization")&&a("Authorization");let e=window.location.hostname;console.log("Checking cookies state...");let t=!1;["amplify-signin-with-hostedUI","amplify-redirected-from-hosted-ui","idToken","accessToken","refreshToken"].forEach(s=>{r(s)&&(console.log(`Found potentially problematic cookie: ${s}`),t=!0,a(s),a(s,{domain:e}))}),t&&(console.log("Performing thorough cookie cleanup"),n())}s.d(t,{Wx:()=>n,nT:()=>o})},3893:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>l});var i=s(997),a=s(968),n=s.n(a);s(108);var o=s(4685);s(4192);var u=s(5838),c=e([o,u]);function l({Component:e,pageProps:t}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n(),{children:[i.jsx("title",{children:"Survey Link Wrapper"}),i.jsx("meta",{name:"description",content:"Wrapping third-party survey links with a validation layer"}),i.jsx("link",{rel:"icon",href:"/favicon.ico"}),i.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),i.jsx(o.H,{children:i.jsx(e,{...t})})]})}[o,u]=c.then?(await c)():c,r()}catch(e){r(e)}})},108:()=>{}};