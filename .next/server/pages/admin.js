"use strict";(()=>{var e={};e.id=964,e.ids=[964,660],e.modules={2465:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>f,default:()=>m,getServerSideProps:()=>u,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>g,routeModule:()=>N,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>k,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var a=s(7093),i=s(5244),l=s(1323),n=s(2899),c=s.n(n),d=s(3893),o=s(110),x=e([o]);o=(x.then?(await x)():x)[0];let m=(0,l.l)(o,"default"),h=(0,l.l)(o,"getStaticProps"),p=(0,l.l)(o,"getStaticPaths"),u=(0,l.l)(o,"getServerSideProps"),f=(0,l.l)(o,"config"),g=(0,l.l)(o,"reportWebVitals"),j=(0,l.l)(o,"unstable_getStaticProps"),y=(0,l.l)(o,"unstable_getStaticPaths"),k=(0,l.l)(o,"unstable_getStaticParams"),v=(0,l.l)(o,"unstable_getServerProps"),b=(0,l.l)(o,"unstable_getServerSideProps"),N=new a.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin",pathname:"/admin",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:o});r()}catch(e){r(e)}})},110:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>x,getServerSideProps:()=>m});var a=s(997),i=s(6689),l=s(1664),n=s.n(l),c=s(5153),d=s(9648),o=e([c,d]);[c,d]=o.then?(await o)():o;let h=({value:e,max:t,color:s,size:r=60,strokeWidth:i=6})=>{let l=r/2-i,n=2*Math.PI*l,c=n-e/(t||1)*n;return(0,a.jsxs)("div",{className:"relative inline-flex",children:[(0,a.jsxs)("svg",{width:r,height:r,viewBox:`0 0 ${r} ${r}`,children:[a.jsx("circle",{cx:r/2,cy:r/2,r:l,fill:"none",stroke:"#e5e7eb",strokeWidth:i}),a.jsx("circle",{cx:r/2,cy:r/2,r:l,fill:"none",stroke:s,strokeWidth:i,strokeDasharray:n,strokeDashoffset:c,strokeLinecap:"round",transform:`rotate(-90 ${r/2} ${r/2})`})]}),(0,a.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium",children:[e,"/",t]})]})};function x({projects:e,stats:t,projectStats:s}){let[r,l]=(0,i.useState)(e),[c,o]=(0,i.useState)(t),[x,m]=(0,i.useState)(null),[p,u]=(0,i.useState)(null),[f,g]=(0,i.useState)(!1),[j,y]=(0,i.useState)(null),k=async e=>{m(e),u(null);try{if((await d.default.delete(`/api/projects/delete?id=${e}`)).data.success){let t=r.filter(t=>t.id!==e);l(t),r.find(t=>t.id===e)&&o(e=>({...e,totalProjects:e.totalProjects-1})),g(!1)}else u("Failed to delete project. Please try again.")}catch(e){console.error("Error deleting project:",e),u("An error occurred while deleting the project. Please try again.")}finally{m(null)}},v=e=>{y(e),g(!0)};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[a.jsx("div",{className:"bg-white shadow",children:a.jsx("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Survey Link Wrapper Admin"})})}),(0,a.jsxs)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg mb-8 p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Overall Statistics"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#6366F1",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:"0",transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c.totalProjects})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Projects"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#6366F1",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:"0",transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c.totalLinks})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Links"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#3B82F6",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-c.pendingLinks/c.totalLinks),transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-blue-600",children:c.pendingLinks})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Pending Links"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#10B981",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-c.startedLinks/c.totalLinks),transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-green-600",children:c.startedLinks})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Started Links"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#059669",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-c.completedLinks/c.totalLinks),transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-green-800",children:c.completedLinks})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Completed Links"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsxs)("svg",{className:"w-24 h-24",children:[a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),a.jsx("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#EF4444",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-c.flaggedLinks/c.totalLinks),transform:"rotate(-90 48 48)"})]}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"text-3xl font-bold text-red-600",children:c.flaggedLinks})})]}),a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Flagged Links"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg mb-8",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Your Projects"}),a.jsx(n(),{href:"/admin/projects/new",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:"Create New Project"})]}),a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Links"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Distribution"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[r.map(e=>{let t=s[e.id]||{pending:0,started:0,inProgress:0,completed:0,flagged:0},r=e._count.surveyLinks;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.description||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e._count.surveyLinks}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex justify-center space-x-1",children:r>0?(0,a.jsxs)(a.Fragment,{children:[a.jsx(h,{value:t.pending,max:r,color:"#3B82F6"}),a.jsx(h,{value:t.started,max:r,color:"#10B981"}),a.jsx(h,{value:t.inProgress,max:r,color:"#F59E0B"}),a.jsx(h,{value:t.completed,max:r,color:"#059669"}),a.jsx(h,{value:t.flagged,max:r,color:"#EF4444"})]}):a.jsx("span",{className:"text-xs text-gray-400",children:"No links generated"})})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[a.jsx(n(),{href:`/admin/projects/${e.id}`,className:"text-blue-600 hover:text-blue-900 mr-4",children:"View"}),a.jsx(n(),{href:`/admin/projects/${e.id}/generate`,className:"text-green-600 hover:text-green-900 mr-4",children:"Generate Links"}),a.jsx("button",{onClick:()=>v(e),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)}),0===r.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No projects found. Create your first project to get started."})})]})]})})]})]}),f&&j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delete Project"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",a.jsx("span",{className:"font-semibold",children:j.name}),"? This will permanently delete the project and all associated data, including:"]}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-gray-600 mb-6",children:[(0,a.jsxs)("li",{children:[j._count.surveyLinks," survey links"]}),a.jsx("li",{children:"All survey responses"}),a.jsx("li",{children:"All pre-survey questions"}),(0,a.jsxs)("li",{children:[j._count.flags," flags"]})]}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This action cannot be undone."}),p&&a.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:p}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[a.jsx("button",{onClick:()=>{y(null),g(!1),u(null)},className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50",disabled:x===j.id,children:"Cancel"}),a.jsx("button",{onClick:()=>k(j.id),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",disabled:x===j.id,children:x===j.id?"Deleting...":"Yes, Delete Project"})]})]})})]})}async function m(){try{let e=(await c.K.projects.list()).data||[],t={totalProjects:e.length,totalLinks:0,pendingLinks:0,startedLinks:0,inProgressLinks:0,completedLinks:0,flaggedLinks:0},s={};e.forEach(e=>{e&&e.id&&(s[e.id]={pending:0,started:0,inProgress:0,completed:0,flagged:0})});let r=(await c.K.surveyLinks.list()).data||[];t.totalLinks=r.length,r.forEach(e=>{if(e.projectId&&e.status&&e.projectId&&s[e.projectId])switch(e.status){case"UNUSED":s[e.projectId].pending+=1,t.pendingLinks+=1;break;case"CLICKED":s[e.projectId].started+=1,t.startedLinks+=1;break;case"CLICKED":s[e.projectId].inProgress+=1,t.inProgressLinks+=1;break;case"COMPLETED":s[e.projectId].completed+=1,t.completedLinks+=1;break;case"DISQUALIFIED":case"QUOTA_FULL":s[e.projectId].flagged+=1,t.flaggedLinks+=1}});let a=[],i={};e.forEach(e=>{if(!e||!e.id)return;let t=r.filter(t=>t.projectId===e.id),s=a.filter(t=>t.projectId===e.id);i[e.id]={surveyLinks:t.length,flags:s.length}});let l=e.map(e=>e&&e.id?{id:e.id,name:e.name,description:e.description,createdAt:e.createdAt,_count:{surveyLinks:i[e.id]?.surveyLinks||0,flags:i[e.id]?.flags||0}}:null).filter(Boolean);return{props:{projects:JSON.parse(JSON.stringify(l)),stats:t,projectStats:s}}}catch(e){return console.error("Error fetching admin dashboard data:",e),{props:{projects:[],stats:{totalProjects:0,totalLinks:0,pendingLinks:0,startedLinks:0,inProgressLinks:0,completedLinks:0,flaggedLinks:0},projectStats:{}}}}}r()}catch(e){r(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},5838:e=>{e.exports=import("aws-amplify")},1534:e=>{e.exports=import("aws-amplify/api")},376:e=>{e.exports=import("aws-amplify/data")},9648:e=>{e.exports=import("axios")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[899,132,664,193],()=>s(2465));module.exports=r})();