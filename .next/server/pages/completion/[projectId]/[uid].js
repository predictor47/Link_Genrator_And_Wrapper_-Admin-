"use strict";(()=>{var e={};e.id=487,e.ids=[487,888,660],e.modules={4827:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>y,getStaticProps:()=>p,reportWebVitals:()=>h,routeModule:()=>b,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>f});var s=a(7093),n=a(5244),l=a(1323),o=a(2899),i=a.n(o),d=a(3893),c=a(8652),u=e([d,c]);[d,c]=u.then?(await u)():u;let m=(0,l.l)(c,"default"),p=(0,l.l)(c,"getStaticProps"),y=(0,l.l)(c,"getStaticPaths"),g=(0,l.l)(c,"getServerSideProps"),x=(0,l.l)(c,"config"),h=(0,l.l)(c,"reportWebVitals"),f=(0,l.l)(c,"unstable_getStaticProps"),j=(0,l.l)(c,"unstable_getStaticPaths"),w=(0,l.l)(c,"unstable_getStaticParams"),v=(0,l.l)(c,"unstable_getServerProps"),S=(0,l.l)(c,"unstable_getServerSideProps"),b=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/completion/[projectId]/[uid]",pathname:"/completion/[projectId]/[uid]",bundlePath:"",filename:""},components:{App:d.default,Document:i()},userland:c});r()}catch(e){r(e)}})},5153:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{K:()=>d});var s=a(1534),n=e([s]);s=(n.then?(await n)():n)[0];let l=(0,s.generateClient)({authMode:"apiKey"}),o=e=>e.data,i=(e,t)=>{let a={operation:t,name:e instanceof Error?e.name:"UnknownError",message:e instanceof Error?e.message:"Unknown error occurred",details:e};throw"object"==typeof e&&null!==e&&"code"in e&&(a.code=String(e.code)),console.error(`Amplify Error (${t}):`,a),e},d={client:l,projects:{create:async e=>{try{let t=await l.models.Project.create(e);return{data:o(t)}}catch(e){i(e,"projects.create")}},get:async e=>{let t=await l.models.Project.get({id:e});return{data:o(t)}},list:async e=>({data:(await l.models.Project.list(e)).data||[]}),update:async(e,t)=>{let a=await l.models.Project.update({id:e,...t});return{data:o(a)}},delete:async e=>{let t=await l.models.Project.delete({id:e});return{data:o(t)}},getWithRelations:async e=>{let t=await l.models.Project.get({id:e});if(t.data){let a=await l.models.SurveyLink.list({filter:{projectId:{eq:e}}}),r=(await l.models.ProjectVendor.list({filter:{projectId:{eq:e}}})).data.map(e=>e.vendorId).filter(e=>null!=e),s=[];r.length>0&&(s=(await Promise.all(r.map(e=>l.models.Vendor.get({id:e})))).filter(e=>null!==e.data).map(e=>e.data));let n=await l.models.Question.list({filter:{projectId:{eq:e}}});return{data:{...t.data,surveyLinks:a.data||[],vendors:s,questions:n.data||[]}}}return{data:null}}},surveyLinks:{create:async e=>{let t=await l.models.SurveyLink.create(e);return{data:o(t)}},get:async e=>{let t=await l.models.SurveyLink.get({id:e});return{data:o(t)}},getByUid:async e=>{let t=await l.models.SurveyLink.list({filter:{uid:{eq:e}}});return{data:t.data&&t.data.length>0?t.data[0]:null}},update:async(e,t)=>{let a=await l.models.SurveyLink.update({id:e,...t});return{data:o(a)}},list:async e=>({data:(await l.models.SurveyLink.list(e)).data||[]}),listByProject:async e=>({data:(await l.models.SurveyLink.list({filter:{projectId:{eq:e}}})).data||[]}),delete:async e=>{let t=await l.models.SurveyLink.delete({id:e});return{data:o(t)}}},vendors:{create:async e=>{let t=await l.models.Vendor.create(e);return{data:o(t)}},get:async e=>{let t=await l.models.Vendor.get({id:e});return{data:o(t)}},list:async e=>({data:(await l.models.Vendor.list(e)).data||[]}),listByProject:async e=>{let t=(await l.models.ProjectVendor.list({filter:{projectId:{eq:e}}})).data.map(e=>e.vendorId).filter(e=>null!=e);return t.length>0?{data:(await Promise.all(t.map(e=>l.models.Vendor.get({id:e})))).filter(e=>null!==e.data).map(e=>e.data)}:{data:[]}},update:async(e,t)=>{let a=await l.models.Vendor.update({id:e,...t});return{data:o(a)}},delete:async e=>{let t=await l.models.Vendor.delete({id:e});return{data:o(t)}}},questions:{create:async e=>{let t=await l.models.Question.create(e);return{data:o(t)}},get:async e=>{let t=await l.models.Question.get({id:e});return{data:o(t)}},list:async e=>({data:(await l.models.Question.list(e)).data||[]}),listByProject:async e=>({data:(await l.models.Question.list({filter:{projectId:{eq:e}}})).data||[]}),update:async(e,t)=>{let a=await l.models.Question.update({id:e,...t});return{data:o(a)}},delete:async e=>{let t=await l.models.Question.delete({id:e});return{data:o(t)}}},transaction:{execute:async e=>{let t=[];for(let a of e){let e=await a;t.push(e)}return t}}};r()}catch(e){r(e)}})},8652:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>m,getServerSideProps:()=>p});var s=a(997),n=a(6689),l=a(1163),o=a(968),i=a.n(o),d=a(9648),c=a(5153),u=e([d,c]);function m({project:e,surveyLink:t,error:a}){(0,l.useRouter)();let[r,o]=(0,n.useState)(!a&&!!t),[d,c]=(0,n.useState)(a||null),[u,m]=(0,n.useState)(!1);if(!e||!t)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:[s.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Survey Not Found"}),s.jsx("p",{className:"text-gray-700 mb-6",children:"Sorry, the survey you are looking for does not exist or has expired."})]})});let p=t.vendorCode?`Thank you for completing the survey via ${t.vendorCode}.`:"Thank you for completing the survey.";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[(0,s.jsxs)("title",{children:["Survey Completed | ",e.name]}),s.jsx("meta",{name:"description",content:"Thank you for completing the survey"})]}),s.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:s.jsx("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:r?(0,s.jsxs)(s.Fragment,{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Recording Completion"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Please wait while we record your survey completion..."}),s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})})]}):d?(0,s.jsxs)(s.Fragment,{children:[s.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error"}),s.jsx("p",{className:"text-gray-700 mb-6",children:d}),s.jsx("p",{className:"text-sm text-gray-500",children:"If this error persists, please contact the survey administrator."})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"mb-6 flex justify-center",children:s.jsx("div",{className:"rounded-full bg-green-100 p-3",children:s.jsx("svg",{className:"h-12 w-12 text-green-600",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{d:"M5 13l4 4L19 7"})})})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Thank You!"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:[p," Your response has been successfully recorded."]}),s.jsx("p",{className:"text-sm text-gray-500",children:"You may now close this window."})]})})})]})}async function p(e){let{projectId:t,uid:a}=e.params;try{let e=await c.K.projects.get(t);if(!e||!e.data)return{props:{project:null,surveyLink:null,error:"Project not found"}};let r=e.data,s=await c.K.surveyLinks.getByUid(a),n=s?.data;if(!n||n.projectId!==t)return{props:{project:{id:r.id,name:r.name},surveyLink:null,error:"Survey link not found"}};let l=null;if(n.vendorId){let e=await c.K.vendors.get(n.vendorId);if(e?.data?.settings)try{l=JSON.parse(e.data.settings).code||null}catch(e){console.error("Error parsing vendor settings:",e)}}let o="";if(n.metadata)try{o=JSON.parse(n.metadata).originalUrl||""}catch(e){console.error("Error parsing link metadata:",e)}return{props:{project:{id:r.id,name:r.name},surveyLink:{uid:n.uid,status:n.status||"PENDING",originalUrl:o,vendorCode:l},error:null}}}catch(e){return console.error("Error fetching data:",e),{props:{project:null,surveyLink:null,error:"Error fetching data"}}}}[d,c]=u.then?(await u)():u,r()}catch(e){r(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},5838:e=>{e.exports=import("aws-amplify")},1534:e=>{e.exports=import("aws-amplify/api")},9779:e=>{e.exports=import("aws-amplify/auth")},9648:e=>{e.exports=import("axios")}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[899,132,163,893],()=>a(4827));module.exports=r})();