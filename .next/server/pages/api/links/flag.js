"use strict";(()=>{var e={};e.id=1513,e.ids=[1513],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5838:e=>{e.exports=import("aws-amplify")},4690:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{config:()=>l,default:()=>o,routeModule:()=>g});var r=t(1802),n=t(7153),i=t(6249),u=t(2064),d=e([u]);u=(d.then?(await d)():d)[0];let o=(0,i.l)(u,"default"),l=(0,i.l)(u,"config"),g=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/links/flag",pathname:"/api/links/flag",bundlePath:"",filename:""},userland:u});s()}catch(e){s(e)}})},2064:(e,a,t)=>{t.a(e,async(e,s)=>{try{t.r(a),t.d(a,{default:()=>i});var r=t(9519),n=e([r]);async function i(e,a){if("POST"!==e.method)return a.status(405).json({message:"Method not allowed"});try{let{projectId:t,uid:s,token:n,reason:i,metadata:u}=e.body;if(!t||!s||!i)return a.status(400).json({success:!1,message:"Missing required fields"});let d=(0,r.j)(),o=(await d.getSurveyLinkByUid(s)).data;if(!o)return a.status(404).json({success:!1,message:"Survey link not found"});if(!o.id)throw Error("Survey link ID is null or undefined");let l={...o.metadata?"string"==typeof o.metadata?JSON.parse(o.metadata):o.metadata:{},flagged:!0,flagReason:i,flaggedAt:new Date().toISOString(),...u||{}};return await d.updateSurveyLink(o.id,{status:"FLAGGED",metadata:JSON.stringify(l)}),a.status(200).json({success:!0,message:"Survey response flagged successfully"})}catch(e){return console.error("Error flagging survey:",e),a.status(500).json({success:!1,message:"Internal server error"})}}r=(n.then?(await n)():n)[0],s()}catch(e){s(e)}})}};var a=require("../../../webpack-api-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[6504],()=>t(4690));module.exports=s})();