"use strict";(()=>{var e={};e.id=605,e.ids=[605,888,660],e.modules={5277:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>y,getStaticPaths:()=>p,getStaticProps:()=>h,reportWebVitals:()=>g,routeModule:()=>S,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>j,unstable_getStaticParams:()=>w,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>f});var s=r(7093),n=r(5244),l=r(1323),o=r(2899),i=r.n(o),d=r(3893),u=r(601),c=e([d,u]);[d,u]=c.then?(await c)():c;let m=(0,l.l)(u,"default"),h=(0,l.l)(u,"getStaticProps"),p=(0,l.l)(u,"getStaticPaths"),y=(0,l.l)(u,"getServerSideProps"),x=(0,l.l)(u,"config"),g=(0,l.l)(u,"reportWebVitals"),f=(0,l.l)(u,"unstable_getStaticProps"),v=(0,l.l)(u,"unstable_getStaticPaths"),w=(0,l.l)(u,"unstable_getStaticParams"),b=(0,l.l)(u,"unstable_getServerProps"),j=(0,l.l)(u,"unstable_getServerSideProps"),S=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/s/[projectId]/[uid]",pathname:"/s/[projectId]/[uid]",bundlePath:"",filename:""},components:{App:d.default,Document:i()},userland:u});a()}catch(e){a(e)}})},6857:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(6689);let s=({onDataCollected:e,startTracking:t=!0})=>{let r=(0,a.useRef)({mouseMovements:0,keyboardEvents:0,clickPattern:[],idleTime:0,mouseCurve:[],copyPasteEvents:0}),s=(0,a.useRef)(Date.now()),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!t)return;let a=e=>{r.current.mouseMovements++,s.current=Date.now(),r.current.mouseMovements%10==0&&(r.current.mouseCurve.push({x:e.clientX,y:e.clientY,timestamp:Date.now()}),r.current.mouseCurve.length>100&&r.current.mouseCurve.shift())},l=e=>{r.current.clickPattern.push(Date.now()),s.current=Date.now(),r.current.clickPattern.length>50&&r.current.clickPattern.shift()},o=e=>{r.current.keyboardEvents++,s.current=Date.now()},i=e=>{r.current.copyPasteEvents++,s.current=Date.now()},d=e=>{r.current.copyPasteEvents++,s.current=Date.now()};return n.current=setInterval(()=>{let t=Date.now()-s.current;r.current.idleTime=Math.floor(t/1e3),t%5e3<1e3&&e({...r.current})},1e3),document.addEventListener("mousemove",a),document.addEventListener("click",l),document.addEventListener("keydown",o),document.addEventListener("copy",i),document.addEventListener("paste",d),e({...r.current}),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("click",l),document.removeEventListener("keydown",o),document.removeEventListener("copy",i),document.removeEventListener("paste",d),n.current&&clearInterval(n.current),e({...r.current})}},[e,t]),null}},2184:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(997),s=r(6689);let n=({onVerify:e,difficulty:t="medium"})=>{let[r,n]=(0,s.useState)(!0),[l,o]=(0,s.useState)({question:"",answer:"",type:"math"}),[i,d]=(0,s.useState)(""),[u,c]=(0,s.useState)(null),[m,h]=(0,s.useState)(!1),[p,y]=(0,s.useState)(0),[x,g]=(0,s.useState)([]),[f,v]=(0,s.useState)([]),[w,b]=(0,s.useState)(0),j=(0,s.useRef)(null),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{N()},[t]);let N=()=>{n(!0),c(null);try{let e;switch(t){case"easy":e=k();break;case"hard":e=L();break;default:e=E()}o(e),"drag"===e.type&&e.items&&(g(e.items),v([]))}catch(e){console.error("Error generating CAPTCHA challenge:",e),c("Failed to generate CAPTCHA challenge")}finally{n(!1)}},k=()=>{let e=Math.floor(10*Math.random()),t=Math.floor(10*Math.random());return{question:`What is ${e} + ${t}?`,answer:String(e+t),type:"math"}},E=()=>{if("math"==(Math.random()>.5?"math":"drag")){let e,t,r;let a=["+","-","*"],s=a[Math.floor(Math.random()*a.length)];switch(s){case"+":r=(e=Math.floor(20*Math.random()))+(t=Math.floor(20*Math.random()));break;case"-":t=Math.floor(Math.random()*(e=Math.floor(20*Math.random())+10)),r=e-t;break;case"*":r=(e=Math.floor(10*Math.random()))*(t=Math.floor(10*Math.random()));break;default:e=0,t=0,r=0}return{question:`What is ${e} ${s} ${t}?`,answer:String(r),type:"math"}}{let e=[{question:"Drag to order from smallest to largest",items:["5","2","9","1","7"],answer:"12579"},{question:"Drag to order alphabetically",items:["dog","cat","bird","fish","ant"],answer:"antbirddogcatfish"}],t=e[Math.floor(Math.random()*e.length)];return{question:t.question,items:[...t.items].sort(()=>Math.random()-.5),answer:t.answer,type:"drag"}}},L=()=>({question:"Hold the button and click the targets that appear",answer:"hold-complete",type:"hold"}),q=t=>{t.preventDefault(),y(e=>e+1),("drag"===l.type?f.join(""):i).trim()===l.answer?(h(!0),e(!0)):(c("Incorrect answer, please try again"),p>=2&&(N(),y(0)))},I=(e,t)=>{e.dataTransfer.setData("text/plain",t)},P=()=>{S.current=Date.now(),j.current=setInterval(()=>{if(S.current){let t=Math.min((Date.now()-S.current)/3e3,1);b(t),t>=1&&(j.current&&clearInterval(j.current),h(!0),e(!0))}},50)},D=()=>{j.current&&(clearInterval(j.current),j.current=null),w<1&&(b(0),S.current=null)};return((0,s.useEffect)(()=>()=>{j.current&&clearInterval(j.current)},[]),r)?a.jsx("div",{className:"flex justify-center p-4",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):m?a.jsx("div",{className:"bg-green-50 p-4 rounded-md",children:a.jsx("p",{className:"text-green-600",children:"Verification successful"})}):(0,a.jsxs)("div",{className:"border p-4 rounded-md shadow-sm mb-4",children:[a.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Security Verification"}),u&&a.jsx("div",{className:"bg-red-50 p-2 rounded-md mb-3",children:a.jsx("p",{className:"text-red-600 text-sm",children:u})}),a.jsx("div",{className:"mb-4",children:a.jsx("p",{className:"text-gray-700",children:l.question})}),"math"===l.type&&(0,a.jsxs)("form",{onSubmit:q,children:[a.jsx("input",{type:"text",value:i,onChange:e=>d(e.target.value),required:!0,placeholder:"Your answer",className:"w-full p-2 border border-gray-300 rounded-md"}),a.jsx("div",{className:"mt-4",children:a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Verify"})})]}),"drag"===l.type&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"min-h-[100px] bg-gray-100 p-4 rounded-md border-2 border-dashed border-gray-300 mb-4",onDrop:e=>{e.preventDefault();let t=e.dataTransfer.getData("text/plain");v(e=>[...e,t]),g(e=>e.filter(e=>e!==t))},onDragOver:e=>{e.preventDefault()},children:[a.jsx("p",{className:"text-gray-500 mb-2",children:"Drop items here in the correct order"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:f.map((e,t)=>a.jsx("div",{className:"bg-blue-100 p-2 rounded-md",children:e},`result-${t}`))})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:x.map((e,t)=>a.jsx("div",{draggable:!0,onDragStart:t=>I(t,e),className:"bg-gray-200 p-2 rounded-md cursor-move",children:e},`item-${t}`))}),f.length===l.items?.length&&a.jsx("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Verify"})]}),"hold"===l.type&&(0,a.jsxs)("div",{children:[a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:a.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${100*w}%`}})}),a.jsx("button",{onMouseDown:P,onMouseUp:D,onMouseLeave:D,onTouchStart:P,onTouchEnd:D,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 w-full",children:"Hold to verify"})]})]})}},4472:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>i});var s=r(997),n=r(6689),l=r(9648),o=e([l]);l=(o.then?(await o)():o)[0];let i=({projectId:e,uid:t,url:r,onStatusChange:a})=>{let[o,i]=(0,n.useState)(!1),[d,u]=(0,n.useState)(null),c=(0,n.useRef)(null),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(!o||!c.current)return;let e=0;return m.current=setInterval(()=>{e++;try{let e=c.current?.contentWindow?.location.href;if(e&&e.includes("protegeresearchsurvey.com")){clearInterval(m.current);let t="COMPLETED";e.includes("/quota")?t="QUOTA_FULL":(e.includes("/not-eligible")||e.includes("/disqualified"))&&(t="DISQUALIFIED"),u(t),h(t,{completionUrl:e})}}catch(e){}e>=300&&clearInterval(m.current)},1e3),()=>{m.current&&clearInterval(m.current)}},[o,e,t]);let h=async(r,s)=>{try{let n={completionTimestamp:new Date().toISOString(),browser:navigator.userAgent,screenSize:{width:window.screen.width,height:window.screen.height,colorDepth:window.screen.colorDepth},language:navigator.language,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,completionUrl:s?.completionUrl,referrer:document.referrer};await l.default.post("/api/links/update-status",{projectId:e,uid:t,status:r,metadata:n}),a(r,{metadata:n,timestamp:Date.now()})}catch(e){console.error("Failed to update survey status:",e)}};return(0,s.jsxs)("div",{className:"iframe-container w-full h-full relative",children:[d&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 bg-white bg-opacity-90",children:(0,s.jsxs)("div",{className:"text-center p-8",children:["COMPLETED"===d&&(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-green-600 mb-4",children:"Survey Completed"}),s.jsx("p",{children:"Thank you for completing the survey! You'll be redirected shortly."})]}),"QUOTA_FULL"===d&&(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-blue-600 mb-4",children:"Survey Quota Full"}),s.jsx("p",{children:"The quota for this survey has been filled. Thank you for your interest!"})]}),"DISQUALIFIED"===d&&(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-amber-600 mb-4",children:"Not Eligible"}),s.jsx("p",{children:"You don't match the criteria for this survey. Thank you for your interest!"})]})]})}),s.jsx("iframe",{ref:c,src:r,onLoad:()=>{i(!0);try{let e=c.current?.contentWindow?.location.href;if(e&&e.includes("protegeresearchsurvey.com")){let t="COMPLETED";e.includes("/quota")?t="QUOTA_FULL":(e.includes("/not-eligible")||e.includes("/disqualified"))&&(t="DISQUALIFIED"),u(t),h(t,{completionUrl:e})}else h("STARTED")}catch(e){h("STARTED")}},className:"w-full h-full border-0 min-h-[500px]",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",sandbox:"allow-same-origin allow-scripts allow-forms allow-popups",title:"Survey iframe"})]})};a()}catch(e){a(e)}})},8275:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>h});var s=r(997),n=r(6689),l=r(1163),o=r(9648),i=r(6857),d=r(6320),u=r(2184),c=r(4472),m=e([o,d,c]);[o,d,c]=m.then?(await m)():m;let h=({projectId:e,uid:t,surveyUrl:r,vendorId:a})=>{let m=(0,l.useRouter)(),[h,p]=(0,n.useState)("captcha"),[y,x]=(0,n.useState)(null),[g,f]=(0,n.useState)(null),[v,w]=(0,n.useState)(!1),[b,j]=(0,n.useState)(!1),[S,N]=(0,n.useState)({token:Math.random().toString(36).substring(2,15),projectId:e,uid:t,vendorId:a,startTime:Date.now(),answers:[],metadata:{}}),k=(0,n.useRef)({rapidAnswers:!1,inconsistentAnswers:!1,botLikeBehavior:!1,flagged:!1,flags:[]});(0,n.useEffect)(()=>{if(S)try{sessionStorage.setItem("surveySession",JSON.stringify(S))}catch(e){console.error("Failed to save session data to sessionStorage:",e)}},[S]);let E=async(r,a,s)=>{if(N(e=>({...e,answers:[...e.answers,{question:r,answer:a,isCorrect:s}]})),!s){k.current.inconsistentAnswers=!0,k.current.flags.push("Incorrect trap question answer");try{await o.default.post("/api/links/flag",{projectId:e,uid:t,reason:"Failed trap question",metadata:{question:r,answer:a,timestamp:Date.now()}})}catch(e){console.error("Failed to flag incorrect trap question:",e)}}j(!0),p("survey")};return(0,s.jsxs)("div",{className:"survey-flow-container relative",children:[s.jsx(i.Z,{onDataCollected:e=>{f(e),N(t=>({...t,metadata:{...t.metadata,behavior:e}})),e.mouseMovements/(e.idleTime||1)>100&&(k.current.botLikeBehavior=!0,k.current.flags.push("Unusually fast mouse movements")),e.copyPasteEvents>5&&(k.current.botLikeBehavior=!0,k.current.flags.push("Excessive copy/paste detected")),k.current.flags.length>0&&N(e=>({...e,metadata:{...e.metadata,suspiciousFlags:k.current.flags}}))},startTracking:!0}),"captcha"===h&&(0,s.jsxs)("div",{className:"p-6 max-w-md mx-auto bg-white rounded-xl shadow-md",children:[s.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-4",children:"Please Verify You Are Human"}),s.jsx(u.Z,{onVerify:e=>{w(e),e&&(N(e=>({...e,metadata:{...e.metadata,captchaVerified:!0,captchaVerifiedAt:Date.now()}})),p("trap-question"))},difficulty:"medium"})]}),"trap-question"===h&&v&&(0,s.jsxs)("div",{className:"p-6 max-w-md mx-auto bg-white rounded-xl shadow-md",children:[s.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-4",children:"Quick Question"}),s.jsx(d.Z,{projectId:e,onAnswer:E})]}),"survey"===h&&v&&s.jsx("div",{className:"w-full h-full",children:s.jsx(c.Z,{projectId:e,uid:t,url:r,onStatusChange:(r,a)=>{switch(r){case"COMPLETED":p("completed"),setTimeout(()=>{m.push(`/thank-you-completed?projectId=${e}&uid=${t}`)},2e3);break;case"QUOTA_FULL":p("quota-full"),setTimeout(()=>{m.push(`/sorry-quota-full?projectId=${e}&uid=${t}`)},2e3);break;case"DISQUALIFIED":p("disqualified"),setTimeout(()=>{m.push(`/sorry-disqualified?projectId=${e}&uid=${t}`)},2e3)}}})}),"error"===h&&(0,s.jsxs)("div",{className:"p-6 max-w-md mx-auto bg-white rounded-xl shadow-md",children:[s.jsx("h2",{className:"text-xl font-medium text-red-600 mb-2",children:"Error"}),s.jsx("p",{className:"text-gray-700",children:y}),s.jsx("button",{onClick:()=>p("captcha"),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]}),("completed"===h||"disqualified"===h||"quota-full"===h)&&(0,s.jsxs)("div",{className:"p-6 max-w-md mx-auto bg-white rounded-xl shadow-md",children:[s.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-4",children:"completed"===h?"Survey Completed":"quota-full"===h?"Survey Quota Full":"Not Eligible"}),s.jsx("p",{className:"text-gray-700",children:"completed"===h?"Thank you for completing the survey. You will be redirected shortly.":"quota-full"===h?"The quota for this survey has been filled. Thank you for your interest.":"You do not match the criteria for this survey. Thank you for your interest."}),s.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Redirecting you in a few seconds..."})]})]})};a()}catch(e){a(e)}})},6320:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>i});var s=r(997),n=r(6689),l=r(5153),o=e([l]);l=(o.then?(await o)():o)[0];let i=({projectId:e,onAnswer:t})=>{let[r,a]=(0,n.useState)(!0),[o,i]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[c,m]=(0,n.useState)(""),[h,p]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{(async()=>{try{a(!0),i(null);let t=(await l.K.questions.listByProject(e)).data||[];if(0===t.length){i("No questions available"),a(!1);return}let r=Math.floor(Math.random()*t.length),s=t[r],n=[];if(s.options)try{"string"==typeof s.options?n=JSON.parse(s.options):Array.isArray(s.options)&&(n=s.options)}catch(e){console.error("Error parsing question options:",e)}u({id:s.id,text:s.text,type:s.type||"TEXT",options:n,correctAnswer:"object"==typeof s.options&&null!==s.options&&s.options.correctAnswer||""})}catch(e){console.error("Error fetching trap question:",e),i("Failed to load question")}finally{a(!1)}})()},[e]),o)?s.jsx("div",{className:"bg-red-50 p-4 rounded-md",children:s.jsx("p",{className:"text-red-600",children:o})}):r?s.jsx("div",{className:"flex justify-center p-4",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):d?h?s.jsx("div",{className:"bg-green-50 p-4 rounded-md",children:s.jsx("p",{className:"text-green-600",children:"Thank you for your response."})}):(0,s.jsxs)("div",{className:"border p-4 rounded-md shadow-sm mb-4",children:[s.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:d.text}),(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),p(!0),!d)return;let r="MULTIPLE_CHOICE"===d.type?c===d.correctAnswer:c.toLowerCase().trim()===d.correctAnswer.toLowerCase().trim();t(d.text,c,r)},children:["MULTIPLE_CHOICE"===d.type&&d.options&&s.jsx("div",{className:"space-y-2",children:d.options.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("input",{type:"radio",id:`option-${t}`,name:"trapAnswer",value:e,onChange:e=>m(e.target.value),required:!0,className:"mr-2"}),s.jsx("label",{htmlFor:`option-${t}`,className:"text-gray-700",children:e})]},t))}),"TEXT"===d.type&&s.jsx("input",{type:"text",value:c,onChange:e=>m(e.target.value),required:!0,placeholder:"Enter your answer here",className:"w-full p-2 border border-gray-300 rounded-md"}),"COUNTRY"===d.type&&(0,s.jsxs)("select",{value:c,onChange:e=>m(e.target.value),required:!0,className:"w-full p-2 border border-gray-300 rounded-md",children:[s.jsx("option",{value:"",children:"Select your country"}),s.jsx("option",{value:"US",children:"United States"}),s.jsx("option",{value:"CA",children:"Canada"}),s.jsx("option",{value:"GB",children:"United Kingdom"}),s.jsx("option",{value:"AU",children:"Australia"})]}),s.jsx("div",{className:"mt-4",children:s.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Submit Answer"})})]})]}):null};a()}catch(e){a(e)}})},5153:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{K:()=>c});var s=r(1534),n=r(5838),l=r(2956),o=e([s,n,l]);[s,n,l]=o.then?(await o)():o,n.Amplify.configure(l.A);let i=(0,s.generateClient)({authMode:"apiKey"}),d=e=>e.data,u=(e,t)=>{let r=e.message||"Unknown error",a=e.name||"Error";throw console.error(`Amplify Error (${t}):`,{name:a,message:r}),e},c={client:i,projects:{create:async e=>{try{let t=await i.models.Project.create(e);return{data:d(t)}}catch(e){u(e,"projects.create")}},get:async e=>{let t=await i.models.Project.get({id:e});return{data:d(t)}},list:async e=>({data:(await i.models.Project.list(e)).data||[]}),update:async(e,t)=>{let r=await i.models.Project.update({id:e,...t});return{data:d(r)}},delete:async e=>{let t=await i.models.Project.delete({id:e});return{data:d(t)}},getWithRelations:async e=>{let t=await i.models.Project.get({id:e});if(t.data){let r=await i.models.SurveyLink.list({filter:{projectId:{eq:e}}}),a=(await i.models.ProjectVendor.list({filter:{projectId:{eq:e}}})).data.map(e=>e.vendorId).filter(e=>null!=e),s=[];a.length>0&&(s=(await Promise.all(a.map(e=>i.models.Vendor.get({id:e})))).filter(e=>null!==e.data).map(e=>e.data));let n=await i.models.Question.list({filter:{projectId:{eq:e}}});return{data:{...t.data,surveyLinks:r.data||[],vendors:s,questions:n.data||[]}}}return{data:null}}},surveyLinks:{create:async e=>{let t=await i.models.SurveyLink.create(e);return{data:d(t)}},get:async e=>{let t=await i.models.SurveyLink.get({id:e});return{data:d(t)}},getByUid:async e=>{let t=await i.models.SurveyLink.list({filter:{uid:{eq:e}}});return{data:t.data&&t.data.length>0?t.data[0]:null}},update:async(e,t)=>{let r=await i.models.SurveyLink.update({id:e,...t});return{data:d(r)}},list:async e=>({data:(await i.models.SurveyLink.list(e)).data||[]}),listByProject:async e=>({data:(await i.models.SurveyLink.list({filter:{projectId:{eq:e}}})).data||[]}),delete:async e=>{let t=await i.models.SurveyLink.delete({id:e});return{data:d(t)}}},vendors:{create:async e=>{let t=await i.models.Vendor.create(e);return{data:d(t)}},get:async e=>{let t=await i.models.Vendor.get({id:e});return{data:d(t)}},list:async e=>({data:(await i.models.Vendor.list(e)).data||[]}),listByProject:async e=>{let t=(await i.models.ProjectVendor.list({filter:{projectId:{eq:e}}})).data.map(e=>e.vendorId).filter(e=>null!=e);return t.length>0?{data:(await Promise.all(t.map(e=>i.models.Vendor.get({id:e})))).filter(e=>null!==e.data).map(e=>e.data)}:{data:[]}},update:async(e,t)=>{let r=await i.models.Vendor.update({id:e,...t});return{data:d(r)}},delete:async e=>{let t=await i.models.Vendor.delete({id:e});return{data:d(t)}}},questions:{create:async e=>{let t=await i.models.Question.create(e);return{data:d(t)}},get:async e=>{let t=await i.models.Question.get({id:e});return{data:d(t)}},list:async e=>({data:(await i.models.Question.list(e)).data||[]}),listByProject:async e=>({data:(await i.models.Question.list({filter:{projectId:{eq:e}}})).data||[]}),update:async(e,t)=>{let r=await i.models.Question.update({id:e,...t});return{data:d(r)}},delete:async e=>{let t=await i.models.Question.delete({id:e});return{data:d(t)}}},transaction:{execute:async e=>{let t=[];for(let r of e){let e=await r;t.push(e)}return t}}};a()}catch(e){a(e)}})},601:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>u,getServerSideProps:()=>c});var s=r(997),n=r(6689),l=r(1163),o=r(5153),i=r(8275),d=e([o,i]);function u({projectId:e,uid:t,project:r,surveyLink:a,isValid:o,errorMessage:d}){(0,l.useRouter)();let[u,c]=(0,n.useState)(d||null);return o&&r?a?.status==="COMPLETED"?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-green-600 mb-4",children:"Survey Already Completed"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"You have already completed this survey. Thank you for your participation!"}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>window.location.href="https://protegeresearch.com",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Return to ProtegeResearch"})})]})}):s.jsx("div",{className:"min-h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[s.jsx("div",{className:"mb-8",children:s.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:r.name})}),s.jsx("div",{className:"bg-white rounded-lg shadow-lg p-2 md:p-6",children:s.jsx(i.Z,{projectId:e,uid:t,surveyUrl:r.surveyUrl,vendorId:a?.vendorId||void 0})})]})}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Invalid Survey Link"}),s.jsx("p",{className:"text-gray-600 mb-6",children:d||"This survey link is invalid or has expired."}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>window.location.href="https://protegeresearch.com",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Return to ProtegeResearch"})})]})})}[o,i]=d.then?(await d)():d;let c=async e=>{let{projectId:t,uid:r}=e.params;try{let e=await o.K.projects.get(t),a=e?.data||null;if(!a)return{props:{projectId:t,uid:r,isValid:!1,errorMessage:"Project not found",project:null,surveyLink:null}};let s=await o.K.surveyLinks.getByUid(r),n=s?.data||null;if(!n)return{props:{projectId:t,uid:r,isValid:!1,errorMessage:"Survey link not found",project:null,surveyLink:null}};if(n.projectId!==t)return{props:{projectId:t,uid:r,isValid:!1,errorMessage:"Invalid project link combination",project:null,surveyLink:null}};if("COMPLETED"===n.status)return{props:{projectId:t,uid:r,isValid:!0,project:{name:a.name,surveyUrl:a.surveyUrl},surveyLink:{status:n.status,vendorId:n.vendorId||null}}};return{props:{projectId:t,uid:r,isValid:!0,project:{name:a.name,surveyUrl:a.surveyUrl},surveyLink:{status:n.status||"UNUSED",vendorId:n.vendorId||null}}}}catch(e){return console.error("Error fetching survey details:",e),{props:{projectId:t,uid:r,isValid:!1,errorMessage:"An error occurred while loading the survey",project:null,surveyLink:null}}}};a()}catch(e){a(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},5838:e=>{e.exports=import("aws-amplify")},1534:e=>{e.exports=import("aws-amplify/api")},9779:e=>{e.exports=import("aws-amplify/auth")},9648:e=>{e.exports=import("axios")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[899,132,163,893],()=>r(5277));module.exports=a})();