(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{4830:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return t(2921)}])},2921:function(e,s,t){"use strict";t.r(s),t.d(s,{__N_SSP:function(){return d},default:function(){return o}});var r=t(5893),a=t(7294),l=t(1664),i=t.n(l),c=t(7066);let n=e=>{let{value:s,max:t,color:a,size:l=60,strokeWidth:i=6}=e,c=l/2-i,n=2*Math.PI*c,d=n-s/(t||1)*n;return(0,r.jsxs)("div",{className:"relative inline-flex",children:[(0,r.jsxs)("svg",{width:l,height:l,viewBox:"0 0 ".concat(l," ").concat(l),children:[(0,r.jsx)("circle",{cx:l/2,cy:l/2,r:c,fill:"none",stroke:"#e5e7eb",strokeWidth:i}),(0,r.jsx)("circle",{cx:l/2,cy:l/2,r:c,fill:"none",stroke:a,strokeWidth:i,strokeDasharray:n,strokeDashoffset:d,strokeLinecap:"round",transform:"rotate(-90 ".concat(l/2," ").concat(l/2,")")})]}),(0,r.jsxs)("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium",children:[s,"/",t]})]})};var d=!0;function o(e){let{projects:s,stats:t,projectStats:l}=e,[d,o]=(0,a.useState)(s),[x,m]=(0,a.useState)(t),[h,f]=(0,a.useState)(null),[u,j]=(0,a.useState)(null),[g,p]=(0,a.useState)(!1),[y,N]=(0,a.useState)(null),v=async e=>{f(e),j(null);try{if((await c.Z.delete("/api/projects/delete?id=".concat(e))).data.success){let s=d.filter(s=>s.id!==e);o(s),d.find(s=>s.id===e)&&m(e=>({...e,totalProjects:e.totalProjects-1})),p(!1)}else j("Failed to delete project. Please try again.")}catch(e){console.error("Error deleting project:",e),j("An error occurred while deleting the project. Please try again.")}finally{f(null)}},k=e=>{N(e),p(!0)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,r.jsx)("div",{className:"bg-white shadow",children:(0,r.jsx)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Survey Link Wrapper Admin"})})}),(0,r.jsxs)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg mb-8 p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Overall Statistics"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#6366F1",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:"0",transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:x.totalProjects})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Total Projects"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#6366F1",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:"0",transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:x.totalLinks})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Total Links"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#3B82F6",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-x.pendingLinks/x.totalLinks),transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:x.pendingLinks})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Pending Links"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#10B981",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-x.startedLinks/x.totalLinks),transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-green-600",children:x.startedLinks})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Started Links"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#059669",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-x.completedLinks/x.totalLinks),transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-green-800",children:x.completedLinks})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Completed Links"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative mb-2",children:[(0,r.jsxs)("svg",{className:"w-24 h-24",children:[(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#e5e7eb",strokeWidth:"8"}),(0,r.jsx)("circle",{cx:"48",cy:"48",r:"40",fill:"none",stroke:"#EF4444",strokeWidth:"8",strokeDasharray:2*Math.PI*40,strokeDashoffset:2*Math.PI*40*(1-x.flaggedLinks/x.totalLinks),transform:"rotate(-90 48 48)"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-3xl font-bold text-red-600",children:x.flaggedLinks})})]}),(0,r.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Flagged Links"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg mb-8",children:[(0,r.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Your Projects"}),(0,r.jsx)(i(),{href:"/admin/projects/new",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:"Create New Project"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Links"}),(0,r.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Distribution"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[d.map(e=>{let s=l[e.id]||{pending:0,started:0,inProgress:0,completed:0,flagged:0},t=e._count.surveyLinks;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.description||"-"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e._count.surveyLinks}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"flex justify-center space-x-1",children:t>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n,{value:s.pending,max:t,color:"#3B82F6"}),(0,r.jsx)(n,{value:s.started,max:t,color:"#10B981"}),(0,r.jsx)(n,{value:s.inProgress,max:t,color:"#F59E0B"}),(0,r.jsx)(n,{value:s.completed,max:t,color:"#059669"}),(0,r.jsx)(n,{value:s.flagged,max:t,color:"#EF4444"})]}):(0,r.jsx)("span",{className:"text-xs text-gray-400",children:"No links generated"})})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,r.jsx)(i(),{href:"/admin/projects/".concat(e.id),className:"text-blue-600 hover:text-blue-900 mr-4",children:"View"}),(0,r.jsx)(i(),{href:"/admin/projects/".concat(e.id,"/generate"),className:"text-green-600 hover:text-green-900 mr-4",children:"Generate Links"}),(0,r.jsx)("button",{onClick:()=>k(e),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)}),0===d.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No projects found. Create your first project to get started."})})]})]})})]})]}),g&&y&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Delete Project"}),(0,r.jsxs)("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",(0,r.jsx)("span",{className:"font-semibold",children:y.name}),"? This will permanently delete the project and all associated data, including:"]}),(0,r.jsxs)("ul",{className:"list-disc list-inside text-gray-600 mb-6",children:[(0,r.jsxs)("li",{children:[y._count.surveyLinks," survey links"]}),(0,r.jsx)("li",{children:"All survey responses"}),(0,r.jsx)("li",{children:"All pre-survey questions"}),(0,r.jsxs)("li",{children:[y._count.flags," flags"]})]}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"This action cannot be undone."}),u&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{N(null),p(!1),j(null)},className:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50",disabled:h===y.id,children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>v(y.id),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",disabled:h===y.id,children:h===y.id?"Deleting...":"Yes, Delete Project"})]})]})})]})}}},function(e){e.O(0,[282,66,664,888,774,179],function(){return e(e.s=4830)}),_N_E=e.O()}]);