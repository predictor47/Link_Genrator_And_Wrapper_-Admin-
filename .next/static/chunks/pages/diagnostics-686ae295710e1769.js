(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{8263:function(e,i,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/diagnostics",function(){return o(8436)}])},8436:function(e,i,o){"use strict";o.r(i),o.d(i,{default:function(){return a}});var d=o(5893),n=o(7294),s=o(1163),l=o(1354),t=o(287);function a(){var e,i,o,a,r,c;let m=(0,s.useRouter)(),[u,h]=(0,n.useState)({environment:"production",domain:window.location.hostname,path:window.location.pathname,amplifyConfigured:!1,authConfigured:!1,apiConfigured:!1,userPoolId:(null===l.A||void 0===l.A?void 0:null===(i=l.A.Auth)||void 0===i?void 0:null===(e=i.Cognito)||void 0===e?void 0:e.userPoolId)||"not-found",userPoolClientId:(null===l.A||void 0===l.A?void 0:null===(a=l.A.Auth)||void 0===a?void 0:null===(o=a.Cognito)||void 0===o?void 0:o.userPoolClientId)||"not-found",apiEndpoint:(null===l.A||void 0===l.A?void 0:null===(c=l.A.API)||void 0===c?void 0:null===(r=c.GraphQL)||void 0===r?void 0:r.endpoint)||"not-found",headers:{},cookies:{},cookieDomain:"",redirectHistory:[],middlewareChecks:0,isAdminDomain:!1,authCookiesFound:!1,potentialRedirectLoop:!1,timestamp:new Date().toISOString()});return(0,n.useEffect)(()=>{let e={};document.cookie.split(";").forEach(i=>{let[o,d]=i.trim().split("=");o&&(e[o]=d||"empty")});let i=sessionStorage.getItem("redirect_count")||"0",o=JSON.parse(sessionStorage.getItem("redirect_history")||"[]"),d=function(){let e={};return"undefined"!=typeof document&&document.cookie.split(";").forEach(i=>{let[o,d]=i.trim().split("=");o&&(e[o]=d||"empty")}),e}(),n=Object.keys(d).some(e=>e.includes("Token")||e.includes("token")||e.includes("Cognito")||e.includes("cognito")||e.includes("aws")||e.includes("Auth")),s=parseInt(i,10)>3||"true"===m.query.redirect_loop||"true"===m.query.fixed;h(a=>{var r,c,m,u,h,x;return{...a,domain:window.location.hostname,path:window.location.pathname,headers:e,cookies:d,cookieDomain:(0,t.yT)()||"not-set",amplifyConfigured:!!l.A,authConfigured:!!((null===l.A||void 0===l.A?void 0:null===(c=l.A.Auth)||void 0===c?void 0:null===(r=c.Cognito)||void 0===r?void 0:r.userPoolId)&&(null===l.A||void 0===l.A?void 0:null===(u=l.A.Auth)||void 0===u?void 0:null===(m=u.Cognito)||void 0===m?void 0:m.userPoolClientId)),apiConfigured:!!(null===l.A||void 0===l.A?void 0:null===(x=l.A.API)||void 0===x?void 0:null===(h=x.GraphQL)||void 0===h?void 0:h.endpoint),middlewareChecks:parseInt(i,10),redirectHistory:o,isAdminDomain:window.location.hostname.startsWith("admin."),authCookiesFound:n,potentialRedirectLoop:s,timestamp:new Date().toISOString()}})},[m.query]),(0,d.jsx)("div",{className:"min-h-screen bg-gray-100 p-8",children:(0,d.jsxs)("div",{className:"max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-6",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Application Diagnostics"}),(0,d.jsxs)("div",{className:"mb-8 p-4 bg-blue-50 rounded-lg",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Actions"}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,d.jsx)("button",{onClick:()=>{(0,t.Wx)(),alert("Authentication cookies cleared. Page will reload."),window.location.reload()},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Clear Auth Cookies"}),(0,d.jsx)("button",{onClick:()=>{(0,t.nT)(),alert("Cookies fixed. Page will reload."),window.location.reload()},className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700",children:"Fix Problem Cookies"}),(0,d.jsx)("button",{onClick:()=>{m.push("/admin/login?fixed=true")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Go to Login Page"})]})]}),u.potentialRedirectLoop&&(0,d.jsxs)("div",{className:"mb-8 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"⚠️ Potential Redirect Loop Detected"}),(0,d.jsx)("p",{className:"text-red-600 mb-2",children:"The system has detected a high number of redirects or a redirect loop parameter in the URL. This may indicate an authentication issue."}),(0,d.jsx)("p",{className:"text-red-600",children:"Try clearing your auth cookies using the button above and then go to the login page."})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Environment Information"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,d.jsx)("div",{className:"font-medium",children:"Environment:"}),(0,d.jsx)("div",{children:u.environment}),(0,d.jsx)("div",{className:"font-medium",children:"Current Domain:"}),(0,d.jsx)("div",{children:u.domain}),(0,d.jsx)("div",{className:"font-medium",children:"Current Path:"}),(0,d.jsx)("div",{children:u.path}),(0,d.jsx)("div",{className:"font-medium",children:"Cookie Domain:"}),(0,d.jsx)("div",{children:u.cookieDomain}),(0,d.jsx)("div",{className:"font-medium",children:"Timestamp:"}),(0,d.jsx)("div",{children:u.timestamp})]})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Amplify Configuration"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,d.jsx)("div",{className:"font-medium",children:"Configured:"}),(0,d.jsx)("div",{children:u.amplifyConfigured?"Yes":"No"}),(0,d.jsx)("div",{className:"font-medium",children:"Auth Configured:"}),(0,d.jsx)("div",{children:u.authConfigured?"Yes":"No"}),(0,d.jsx)("div",{className:"font-medium",children:"API Configured:"}),(0,d.jsx)("div",{children:u.apiConfigured?"Yes":"No"})]})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Auth Details"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,d.jsx)("div",{className:"font-medium",children:"User Pool ID:"}),(0,d.jsx)("div",{className:"break-all",children:u.userPoolId}),(0,d.jsx)("div",{className:"font-medium",children:"Auth Cookies Found:"}),(0,d.jsx)("div",{className:u.authCookiesFound?"text-green-600":"text-red-600",children:u.authCookiesFound?"Yes":"No"})]})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"API Details"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,d.jsx)("div",{className:"font-medium",children:"GraphQL Endpoint:"}),(0,d.jsx)("div",{className:"break-all",children:u.apiEndpoint})]})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Cookie Information"}),(0,d.jsx)("pre",{className:"bg-gray-100 p-3 rounded overflow-auto max-h-60",children:JSON.stringify(u.cookies,null,2)})]}),(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Redirect Information"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,d.jsx)("div",{className:"font-medium",children:"Is Admin Domain:"}),(0,d.jsx)("div",{children:u.isAdminDomain?"Yes":"No"}),(0,d.jsx)("div",{className:"font-medium",children:"Middleware Check Count:"}),(0,d.jsxs)("div",{className:u.middlewareChecks>3?"text-red-600 font-bold":"",children:[u.middlewareChecks,u.middlewareChecks>3&&" (High - possible redirect loop)"]}),(0,d.jsx)("div",{className:"font-medium",children:"Query Parameters:"}),(0,d.jsx)("div",{className:"break-all",children:JSON.stringify(m.query)})]}),(0,d.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Redirect History:"}),(0,d.jsx)("pre",{className:"bg-gray-100 p-3 rounded overflow-auto max-h-60",children:JSON.stringify(u.redirectHistory,null,2)})]})]})})}(0,l.n)()},1163:function(e,i,o){e.exports=o(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8263)}),_N_E=e.O()}]);