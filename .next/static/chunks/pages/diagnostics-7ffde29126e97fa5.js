(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{8263:function(e,i,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/diagnostics",function(){return s(8436)}])},8436:function(e,i,s){"use strict";s.r(i),s.d(i,{default:function(){return a}});var o=s(5893),n=s(7294),d=s(1163),t=s(7510),l=s(287);function a(){let e=(0,d.useRouter)(),[i,s]=(0,n.useState)({environment:"production",domain:window.location.hostname,path:window.location.pathname,amplifyConfigured:!1,authConfigured:!1,apiConfigured:!1,userPoolId:"not-found",userPoolClientId:"not-found",apiEndpoint:"not-found",headers:{},cookies:{},cookieDomain:"",redirectHistory:[],middlewareChecks:0,isAdminDomain:!1,authCookiesFound:!1,potentialRedirectLoop:!1,timestamp:new Date().toISOString()});return(0,n.useEffect)(()=>{let i=(0,t.m)(),o={};document.cookie.split(";").forEach(e=>{let[i,s]=e.trim().split("=");i&&(o[i]=s||"empty")});let n=sessionStorage.getItem("redirect_count")||"0",d=JSON.parse(sessionStorage.getItem("redirect_history")||"[]"),a=function(){let e={};return"undefined"!=typeof document&&document.cookie.split(";").forEach(i=>{let[s,o]=i.trim().split("=");s&&(e[s]=o||"empty")}),e}(),r=Object.keys(a).some(e=>e.includes("Token")||e.includes("token")||e.includes("Cognito")||e.includes("cognito")||e.includes("aws")||e.includes("Auth")),c=parseInt(n,10)>3||"true"===e.query.redirect_loop||"true"===e.query.fixed;s(e=>{var s,t,m;return{...e,domain:window.location.hostname,path:window.location.pathname,headers:o,cookies:a,cookieDomain:(0,l.yT)()||"not-set",amplifyConfigured:!!i,authConfigured:!!((null==i?void 0:null===(s=i.auth)||void 0===s?void 0:s.user_pool_id)&&(null==i?void 0:null===(t=i.auth)||void 0===t?void 0:t.user_pool_client_id)),apiConfigured:!!(null==i?void 0:null===(m=i.data)||void 0===m?void 0:m.url),middlewareChecks:parseInt(n,10),redirectHistory:d,isAdminDomain:window.location.hostname.startsWith("admin."),authCookiesFound:r,potentialRedirectLoop:c,timestamp:new Date().toISOString()}})},[e.query]),(0,o.jsx)("div",{className:"min-h-screen bg-gray-100 p-8",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-6",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Application Diagnostics"}),(0,o.jsxs)("div",{className:"mb-8 p-4 bg-blue-50 rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Actions"}),(0,o.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,o.jsx)("button",{onClick:()=>{(0,l.Wx)(),alert("Authentication cookies cleared. Page will reload."),window.location.reload()},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Clear Auth Cookies"}),(0,o.jsx)("button",{onClick:()=>{(0,l.nT)(),alert("Cookies fixed. Page will reload."),window.location.reload()},className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700",children:"Fix Problem Cookies"}),(0,o.jsx)("button",{onClick:()=>{e.push("/admin/login?fixed=true")},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Go to Login Page"})]})]}),i.potentialRedirectLoop&&(0,o.jsxs)("div",{className:"mb-8 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-red-700 mb-2",children:"⚠️ Potential Redirect Loop Detected"}),(0,o.jsx)("p",{className:"text-red-600 mb-2",children:"The system has detected a high number of redirects or a redirect loop parameter in the URL. This may indicate an authentication issue."}),(0,o.jsx)("p",{className:"text-red-600",children:"Try clearing your auth cookies using the button above and then go to the login page."})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Environment Information"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,o.jsx)("div",{className:"font-medium",children:"Environment:"}),(0,o.jsx)("div",{children:i.environment}),(0,o.jsx)("div",{className:"font-medium",children:"Current Domain:"}),(0,o.jsx)("div",{children:i.domain}),(0,o.jsx)("div",{className:"font-medium",children:"Current Path:"}),(0,o.jsx)("div",{children:i.path}),(0,o.jsx)("div",{className:"font-medium",children:"Cookie Domain:"}),(0,o.jsx)("div",{children:i.cookieDomain}),(0,o.jsx)("div",{className:"font-medium",children:"Timestamp:"}),(0,o.jsx)("div",{children:i.timestamp})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Amplify Configuration"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,o.jsx)("div",{className:"font-medium",children:"Configured:"}),(0,o.jsx)("div",{children:i.amplifyConfigured?"Yes":"No"}),(0,o.jsx)("div",{className:"font-medium",children:"Auth Configured:"}),(0,o.jsx)("div",{children:i.authConfigured?"Yes":"No"}),(0,o.jsx)("div",{className:"font-medium",children:"API Configured:"}),(0,o.jsx)("div",{children:i.apiConfigured?"Yes":"No"})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Auth Details"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,o.jsx)("div",{className:"font-medium",children:"User Pool ID:"}),(0,o.jsx)("div",{className:"break-all",children:i.userPoolId}),(0,o.jsx)("div",{className:"font-medium",children:"Auth Cookies Found:"}),(0,o.jsx)("div",{className:i.authCookiesFound?"text-green-600":"text-red-600",children:i.authCookiesFound?"Yes":"No"})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"API Details"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,o.jsx)("div",{className:"font-medium",children:"GraphQL Endpoint:"}),(0,o.jsx)("div",{className:"break-all",children:i.apiEndpoint})]})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Cookie Information"}),(0,o.jsx)("pre",{className:"bg-gray-100 p-3 rounded overflow-auto max-h-60",children:JSON.stringify(i.cookies,null,2)})]}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Redirect Information"}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,o.jsx)("div",{className:"font-medium",children:"Is Admin Domain:"}),(0,o.jsx)("div",{children:i.isAdminDomain?"Yes":"No"}),(0,o.jsx)("div",{className:"font-medium",children:"Middleware Check Count:"}),(0,o.jsxs)("div",{className:i.middlewareChecks>3?"text-red-600 font-bold":"",children:[i.middlewareChecks,i.middlewareChecks>3&&" (High - possible redirect loop)"]}),(0,o.jsx)("div",{className:"font-medium",children:"Query Parameters:"}),(0,o.jsx)("div",{className:"break-all",children:JSON.stringify(e.query)})]}),(0,o.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Redirect History:"}),(0,o.jsx)("pre",{className:"bg-gray-100 p-3 rounded overflow-auto max-h-60",children:JSON.stringify(i.redirectHistory,null,2)})]})]})})}},1163:function(e,i,s){e.exports=s(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8263)}),_N_E=e.O()}]);