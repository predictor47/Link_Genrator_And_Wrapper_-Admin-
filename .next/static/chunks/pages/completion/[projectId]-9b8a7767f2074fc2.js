(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[623],{2802:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/completion/[projectId]",function(){return t(5531)}])},5531:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSP:function(){return c},default:function(){return d}});var s=t(5893),n=t(7294),o=t(1163),l=t(9008),a=t.n(l),i=t(7066),c=!0;function d(e){let{project:r,error:t}=e,{uid:l}=(0,o.useRouter)().query,[c,d]=(0,n.useState)(!0),[m,u]=(0,n.useState)(t||null),[x,h]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{r&&l&&"string"==typeof l?(async()=>{try{let e=null;try{let r=sessionStorage.getItem("surveySession");r&&(e=JSON.parse(r))}catch(e){console.error("Error reading session storage:",e)}let t=await i.Z.post("/api/links/complete",{projectId:r.id,uid:l,token:null==e?void 0:e.token,metadata:{completionTimestamp:new Date().toISOString(),browser:navigator.userAgent,completionHost:window.location.hostname,referrer:document.referrer,sessionData:e}});t.data.success?(h(!0),sessionStorage.removeItem("surveySession")):u(t.data.message||"Failed to record survey completion")}catch(r){var e,t;console.error("Error marking survey as complete:",r),u((null===(t=r.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"An error occurred while recording your completion")}finally{d(!1)}})():d(!1)},[r,l]),r)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a(),{children:[(0,s.jsxs)("title",{children:["Survey Completed | ",r.name]}),(0,s.jsx)("meta",{name:"description",content:"Thank you for completing the survey"})]}),(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,s.jsx)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Recording Completion"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Please wait while we record your survey completion..."}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})})]}):m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error"}),(0,s.jsx)("p",{className:"text-gray-700 mb-6",children:m}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"If this error persists, please contact the survey administrator."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"mb-6 flex justify-center",children:(0,s.jsx)("div",{className:"rounded-full bg-green-100 p-3",children:(0,s.jsx)("svg",{className:"h-12 w-12 text-green-600",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{d:"M5 13l4 4L19 7"})})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Thank You!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Your survey has been successfully completed and recorded."}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"You may now close this window."})]})})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Project Not Found"}),(0,s.jsx)("p",{className:"text-gray-700 mb-6",children:"Sorry, the project you are looking for does not exist."})]})})}}},function(e){e.O(0,[143,888,774,179],function(){return e(e.s=2802)}),_N_E=e.O()}]);