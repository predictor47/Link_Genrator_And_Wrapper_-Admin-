(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[945],{7774:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/verify",function(){return s(5868)}])},1354:function(e,t,s){"use strict";s.d(t,{nq:function(){return n}});var r=s(9556);let a=!1;function n(){var e,t,s,n,i,o;if(a)return;let c=null,l=(null===(e=(c={auth:{userPoolId:"us-east-1_QIwwMdokt",userPoolClientId:"your_client_id_here",identityPoolId:"your_identity_pool_id_here",region:"us-east-1"},api:{endpoint:"https://235kq6cpbbdyfizalvutob7vh4.appsync-api.us-east-1.amazonaws.com/graphql",region:"us-east-1"}}).auth)||void 0===e?void 0:e.region)||"us-east-1";try{let e={Auth:{Cognito:{userPoolId:(null===(t=c.auth)||void 0===t?void 0:t.userPoolId)||"",userPoolClientId:(null===(s=c.auth)||void 0===s?void 0:s.userPoolClientId)||"",identityPoolId:(null===(n=c.auth)||void 0===n?void 0:n.identityPoolId)||""}},API:{GraphQL:{endpoint:(null===(i=c.api)||void 0===i?void 0:i.endpoint)||"",region:(null===(o=c.api)||void 0===o?void 0:o.region)||l,defaultAuthMode:"userPool"}}};e.region=l,r.V.configure(e),a=!0}catch(e){console.error("Error configuring Amplify:",e)}}},6359:function(e,t,s){"use strict";s.d(t,{e:function(){return h}});var r=s(2195),a=s(7271),n=s(4638),i=s(8689),o=s(6398),c=s(1231),l=s(4669),d=s(267),u=s(5566),m=s(379);(0,s(1354).nq)();class h{static async signUp(e){try{let{username:t,password:s,email:a,firstName:n,lastName:i}=e,o={email:a,...n&&{name:n},...i&&{family_name:i}},c=await (0,r.y)({username:t,password:s,options:{userAttributes:o}});return{isSuccess:!0,message:"Sign up successful! Please check your email for a verification code.",data:c}}catch(e){if(console.error("Sign up error:",e),"UsernameExistsException"===e.name)return{isSuccess:!1,message:"This username is already taken. Please try another one."};if("InvalidPasswordException"===e.name)return{isSuccess:!1,message:e.message||"Password does not meet requirements."};return{isSuccess:!1,message:e.message||"Failed to sign up. Please try again later."}}}static async confirmSignUp(e,t){try{await (0,a._)({username:e,confirmationCode:t})}catch(e){throw console.error("Confirm sign up error:",e),e}}static async signIn(e){try{let{username:t,password:s}=e;return await (0,n.z)({username:t,password:s})}catch(e){if(console.error("Sign in error:",e),"UserNotConfirmedException"===e.name)throw Error("Please confirm your account by entering the verification code sent to your email.");if("NotAuthorizedException"===e.name)throw Error("Incorrect username or password.");if("UserNotFoundException"===e.name)throw Error("User does not exist.");throw e}}static async signOut(){try{await (0,i.w)()}catch(e){throw console.error("Sign out error:",e),e}}static async getCurrentUser(){try{return await (0,o.t)()}catch(e){return null}}static async getCurrentSession(){try{return await (0,o.t)()}catch(e){return null}}static async isAuthenticated(){try{return await (0,o.t)(),!0}catch(e){return!1}}static async getUserAttributes(){try{return await (0,c.v)()}catch(e){return null}}static async updateUserAttributes(e){try{return await (0,l.V)({userAttributes:e}),{isSuccess:!0,message:"User attributes updated successfully."}}catch(e){return console.error("Update user attributes error:",e),{isSuccess:!1,message:e.message||"Failed to update user attributes."}}}static async changePassword(e,t){try{if(!await (0,o.t)())throw Error("User is not authenticated");if(!(await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPassword:e,newPassword:t})})).ok)throw Error("Failed to change password");return{isSuccess:!0,message:"Password changed successfully."}}catch(e){return console.error("Change password error:",e),{isSuccess:!1,message:e.message||"Failed to change password."}}}static async forgotPassword(e){try{return await (0,d.c)({username:e}),{isSuccess:!0,message:"Password reset code sent to your email."}}catch(e){return console.error("Forgot password error:",e),{isSuccess:!1,message:e.message||"Failed to send password reset code."}}}static async forgotPasswordSubmit(e,t,s){try{return await (0,u.f)({username:e,confirmationCode:t,newPassword:s}),{isSuccess:!0,message:"Password has been reset successfully."}}catch(e){return console.error("Forgot password submit error:",e),{isSuccess:!1,message:e.message||"Failed to reset password."}}}static async resendConfirmationCode(e){try{return await (0,m.T)({username:e}),{isSuccess:!0,message:"Confirmation code resent successfully."}}catch(e){return console.error("Resend confirmation code error:",e),{isSuccess:!1,message:e.message||"Failed to resend confirmation code."}}}static async getIdToken(){try{let e=await (0,o.t)();if(e&&e.signInDetails)return await fetch("/api/auth/get-id-token").then(e=>e.text()).catch(()=>null);return null}catch(e){return null}}}},5868:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var r=s(5893),a=s(7294),n=s(1163),i=s(9008),o=s.n(i),c=s(1664),l=s.n(c),d=s(6359);function u(){let e=(0,n.useRouter)(),{username:t}=e.query,[s,i]=(0,a.useState)(""),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[f,x]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{try{let t=await d.e.isAuthenticated();y(t),t&&e.replace("/admin")}catch(e){console.error("Auth check error:",e)}})()},[e]);let p=async r=>{if(r.preventDefault(),u(!0),h(null),!t||"string"!=typeof t){h("Username is required. Please go back to the signup page."),u(!1);return}try{await d.e.confirmSignUp(t,s),x(!0),setTimeout(()=>{e.push("/admin/login")},3e3)}catch(e){h(e.message||"Failed to verify account. Please try again.")}finally{u(!1)}};return g?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:(0,r.jsxs)("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Already logged in"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Redirecting to admin dashboard..."})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o(),{children:[(0,r.jsx)("title",{children:"Verify Account | Survey Link Manager"}),(0,r.jsx)("meta",{name:"description",content:"Verify your account for the survey link management admin panel"})]}),(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-100 px-4 py-12 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"w-full max-w-md space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900",children:"Verify Your Account"}),(0,r.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter the verification code sent to your email"})]}),m&&(0,r.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-red-700",children:m})]})]})}),f?(0,r.jsx)("div",{className:"rounded-md bg-green-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Success"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-green-700",children:(0,r.jsx)("p",{children:"Your account has been successfully verified. Redirecting to login page..."})})]})]})}):(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:p,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)("input",{id:"username",name:"username",type:"text",readOnly:!0,className:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",value:t||""})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700",children:"Verification Code"}),(0,r.jsx)("input",{id:"code",name:"code",type:"text",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm",placeholder:"Enter verification code",value:s,onChange:e=>i(e.target.value)})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",className:"group relative flex w-full justify-center rounded-md border border-transparent bg-blue-600 py-2 px-4 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",disabled:c,children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:(0,r.jsxs)("svg",{className:"h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),"Verifying..."]}):"Verify Account"})}),(0,r.jsxs)("div",{className:"text-sm text-center",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Didn't receive a code? "}),(0,r.jsx)(l(),{href:"/admin/resend-code",className:"font-medium text-blue-600 hover:text-blue-500",children:"Resend code"})]}),(0,r.jsx)("div",{className:"text-sm text-center",children:(0,r.jsx)(l(),{href:"/admin/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Back to login"})})]})]})})]})}(0,s(1354).nq)()}},function(e){e.O(0,[282,664,788,888,774,179],function(){return e(e.s=7774)}),_N_E=e.O()}]);