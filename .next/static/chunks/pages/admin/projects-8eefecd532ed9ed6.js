(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{4460:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/projects",function(){return n(4257)}])},7555:function(e,t,n){"use strict";n.d(t,{OA:function(){return c},XR:function(){return i}});var s=n(9319),o=n(6398);async function r(){let e={timestamp:new Date().toISOString(),cookies:{},session:null,user:null,errors:[]};"undefined"!=typeof document&&document.cookie.split(";").forEach(t=>{let[n,s]=t.split("=").map(e=>e.trim());(n.includes("CognitoIdentityServiceProvider")||n.includes("amplify")||n.includes("Token"))&&(e.cookies[n]=s?"present":"empty")});try{var t,n;let o=await (0,s.y)();e.session={hasIdToken:!!(null===(t=o.tokens)||void 0===t?void 0:t.idToken),hasAccessToken:!!(null===(n=o.tokens)||void 0===n?void 0:n.accessToken),hasTokens:!!o.tokens}}catch(t){e.errors.push({source:"fetchAuthSession",message:t instanceof Error?t.message:String(t)})}try{let t=await (0,o.t)();e.user={userId:t.userId,username:t.username,signInDetails:t.signInDetails}}catch(t){e.errors.push({source:"getCurrentUser",message:t instanceof Error?t.message:String(t)})}return e}async function i(){try{let e=await r();console.log("=== AUTH DIAGNOSTICS ==="),console.log(JSON.stringify(e,null,2)),console.log("=======================")}catch(e){console.error("Failed to get auth diagnostics:",e)}}async function c(){try{let e=await r();if(e.errors.length>0&&Object.keys(e.cookies).length>0)return"undefined"!=typeof document&&document.cookie.split(";").forEach(e=>{let[t]=e.split("=").map(e=>e.trim());(t.includes("CognitoIdentityServiceProvider")||t.includes("amplify")||t.includes("Token"))&&(console.log("Clearing problematic cookie:",t),document.cookie="".concat(t,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"))}),window.location.reload(),!0;return!1}catch(e){return console.error("Failed to fix auth issues:",e),!1}}},9051:function(e,t,n){"use strict";n.d(t,{a:function(){return s.a}});var s=n(9985)},3101:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var s=n(5893),o=n(7294),r=n(1163),i=n(9051),c=n(7555);function a(e){let{children:t,redirectTo:n="/admin/login"}=e,{isAuthenticated:a,isLoading:l}=(0,i.a)(),u=(0,r.useRouter)(),[d,m]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{if("undefined"!=typeof document){let e=document.cookie.match(/redirect_count=(\d+)/);if((e?parseInt(e[1],10):0)>5){m(!0);return}}l||a||(console.log("User not authenticated, redirecting to login page"),(0,c.XR)().then(()=>{let e=encodeURIComponent(u.asPath);window.location.href="".concat(n,"?redirect=").concat(e)}))},[a,l,n,u]),d)?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded shadow text-center max-w-md mx-auto",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"Too many login attempts"}),(0,s.jsx)("p",{className:"mb-4",children:"You have been redirected too many times. Please clear your cookies, log in again, or contact support if the problem persists."})]})}):l?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}):a?(0,s.jsx)(s.Fragment,{children:t}):null}},4257:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var s=n(5893),o=n(7294),r=n(1163),i=n(3101);function c(){let e=(0,r.useRouter)();return(0,o.useEffect)(()=>{e.replace("/admin")},[e]),(0,s.jsx)(i.Z,{children:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Redirecting to Dashboard..."}),(0,s.jsx)("p",{className:"text-gray-600",children:"Please wait."})]})})})}},1163:function(e,t,n){e.exports=n(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4460)}),_N_E=e.O()}]);